@if(isLoaded)
{
<div class="form-container">
    <h2 class="form-title">Novo Agente</h2>
    <form [formGroup]="agentForm" (ngSubmit)="onSubmit()">
        <div formGroupName="name">
            <div class="form-row">
                <div class="form-group">
                    <label for="firstName">Primeiro Nome</label>
                    <input type="text" id="firstName" formControlName="firstName" placeholder="Digite o primeiro nome"
                        required>
                </div>
                @if(agentForm.get('firstName')?.invalid &&
                (agentForm.get('FirstName')?.dirty || agentForm.get('firstName')?.touched))
                {
                <div class="error-message">Nome inválido</div>
                }
                <div class="form-group">
                    <label for="lastName">Ultimo Nome</label>
                    <input type="text" id="lastName" formControlName="lastName" placeholder="Digite o último nome"
                        required>
                </div>

                @if(agentForm.get('lastName')?.invalid &&
                (agentForm.get('lastName')?.dirty || agentForm.get('lastName')?.touched))
                {
                <div class="error-message">Nome inválido</div>
                }
            </div>
            <div class="form-group">
                <label for="middleNames">Nomes do Meio</label>
                <input type="text" id="middleNames" formControlName="middleNames" placeholder="Digite os nomes do meio"
                    required>
            </div>
            @if(agentForm.get('middleNames')?.invalid &&
            (agentForm.get('middleNames')?.dirty || agentForm.get('middleNames')?.touched))
            {
            <div class="error-message">Nome inválido</div> }
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="isActive">Activo</label>
                <select id="isActive" name="isActive" formControlName="isActive" required>
                    <option value="true">Sim</option>
                    <option value="false">Não</option>
                </select>
            </div>
            @if(agentForm.get('isActive')?.invalid &&
            (agentForm.get('isActive')?.dirty || agentForm.get('isActive')?.touched))
            {
            <div class="error-message">Opção inválida</div>
            }
            <div class="form-group">
                <label for="role">Função</label>
                <select id="role" name="role" formControlName="role" required>
                    <option value='0'>Agente</option>
                    <option value='1'>Gestor de Agentes</option>
                    <option value='2'>Direcção</option>
                    <option value='3'>Administrador</option>
                </select>
            </div>
            @if(agentForm.get('role')?.invalid &&
            (agentForm.get('role')?.dirty || agentForm.get('role')?.touched))
            {
            <div class="error-message">Opção inválida</div> }
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="dateOfBirth">Data de Nascimento</label>
                <input type="date" id="dateOfBirth" formControlName="dateOfBirth"
                    placeholder="Digite a data de nascimento">
            </div>
            @if(agentForm.get('dateOfBirth')?.invalid &&
            (agentForm.get('dateOfBirth')?.dirty || agentForm.get('dateOfBirth')?.touched))
            {
            <div class="error-message">Data inválida</div>
            }
            <div class="form-group">
                <label for="gender">Género</label>
                <select id="gender" name="gender" formControlName="gender" required>
                    <option value="Masculino">Masculino</option>
                    <option value="Feminino">Feminino</option>
                </select>
            </div>
            @if(agentForm.get('gender')?.invalid &&
            (agentForm.get('gender')?.dirty || agentForm.get('gender')?.touched))
            {
            <div class="error-message">Opção inválida</div>
            }
        </div>

        <div class="form-group">
            <label for="hiredDate">Data de Contratação</label>
            <input type="date" id="hiredDate" formControlName="hiredDate" placeholder="Digite a data de contratação">
        </div>
        @if(agentForm.get('hiredDate')?.invalid &&
        (agentForm.get('hiredDate')?.dirty || agentForm.get('hiredDate')?.touched))
        {
        <div class="error-message">Data inválida</div>
        }
        <div class="form-group">
            <label for="dateOfTermination">Data de rescisão</label>
            <input type="date" id="dateOfTermination" formControlName="dateOfTermination"
                placeholder="Digite a data de rescisão">
        </div>
        @if(agentForm.get('dateOfTermination')?.invalid &&
        (agentForm.get('dateOfTermination')?.dirty || agentForm.get('dateOfTermination')?.touched))
        {
        <div class="error-message">Data inválida</div>
        }
        <div class="form-group">
            <label for="photoFileName">Foto</label>
            <input type="text" id="photoFileName" formControlName="photoFileName"
                placeholder="Digite o nome do arquivo da foto">
        </div>
        @if(agentForm.get('photoFileName')?.invalid &&
        (agentForm.get('photoFileName')?.dirty || agentForm.get('photoFileName')?.touched))
        {
        <div class="error-message">Nome inválido</div>
        }
        <div class="form-group">
            <label for="supervisorId">Supervisor</label>
            <input type="text" id="supervisorId" formControlName="supervisorId" placeholder="Digite o id do supervisor">
        </div>
        @if(agentForm.get('supervisorId')?.invalid &&
        (agentForm.get('supervisorId')?.dirty || agentForm.get('supervisorId')?.touched))
        {
        <div class="error-message">ID inválido</div>
        }
        <div class="form-actions">
            <button type="submit" class="btn-submit">Salvar</button>

            @if(agent.entityLink?.account)
            {
            <a [routerLink]="['/main-page/agent-edit-account',agent.id]">Editar Conta</a>
            }
            @else
            {
            <a [routerLink]="['/main-page/agent-new-account',agent.id]">Criar Conta</a>
            }

            @if(agent.entityLink?.addresses)
            {
            <a [routerLink]="['/main-page/agent-edit-address',agent.id]">Editar Endereço</a>
            }
            @else
            {
            <a [routerLink]="['/main-page/agent-new-address',agent.id]">Criar Endereço</a>
            }

            @if(agent.entityLink?.contacts)
            {
            <a [routerLink]="['/main-page/agent-edit-contact',agent.id]">Editar Contacto</a>
            }
            @else
            {
            <a [routerLink]="['/main-page/agent-new-contact',agent.id]">Criar Contacto</a>
            }
            <a [routerLink]="['/main-page/agent-list']" class="btn-reset">Cancelar</a>
        </div>
    </form>
</div>
}